"use strict";var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=t():e.BannerArrows=t()}(window,function(){var r={id:"",width:0,height:0,arrows:{numbers:10,width:100,height:10,margin:1,labels:[],labelMargin:1,activeIndex:-1},style:{arrowFillStyle:"rgba(195,165,0,1)",arrowActiveStyle:"rgba(295,65,0,1)",textFont:"16px sans-serif",textColor:"#000",textAlpha:1},events:{click:function(e,t){}}},e=function(){function n(e){_classCallCheck(this,n),this.setting=_extends({},r,e);var t=document.getElementById(this.setting.id);this.canvas=t instanceof HTMLCanvasElement?t:c.appendCanvas2Target(t,c.generatorUUId(),this.setting.width,this.setting.height),this.canvasWidth=this.canvas.width,this.canvasHeight=this.canvas.height,this.arrowsSetting=_extends({},r.arrows,e.arrows),this.styleSetting=_extends({},r.style,e.style),this.events=_extends({},r.events,e.events),this.vertexes=n.createArrowVertex(this.arrowsSetting,this.styleSetting),this.ctx=this.canvas.getContext("2d");var i=this;this.canvas.addEventListener("click",function(e){var t=c.getEventPosition(e),n=i.ctx,r=i.vertexes.rect;if(n.beginPath(),n.rect(r[0],r[1],r[2],r[3]),n.isPointInPath(t.x,t.y)){n.clearRect(r[0],r[1],r[2],r[3]);var a=i.draw(c.getEventPosition(e));i.vertexes.selecIndex=a,i.events.click&&i.events.click(i.arrowsSetting.labels[a],a)}}),this.draw()}return _createClass(n,[{key:"draw",value:function(r){var a=this.ctx,e=this.vertexes,t=this.canvasWidth,n=this.canvasHeight,i=this.vertexes.activeIndex,s=this.styleSetting;a.clearRect(0,0,t,n);var o=e.rect;r&&(a.beginPath(),a.rect(o[0],o[1],o[2],o[3]),a.isPointInPath(r.x,r.y),a.clearRect(o[0],o[1],o[2],o[3])),e.arrowVertexes.forEach(function(e,t){a.save(),a.beginPath(),a.moveTo(e[1][0],e[1][1]);for(var n=2;n<e.length;n++)a.lineTo(e[n][0],e[n][1]);a.closePath(),a.fillStyle=e[0],r&&(a.isPointInPath(r.x,r.y)?(a.fillStyle=s.arrowActiveStyle,i=t):a.fillStyle=s.arrowFillStyle,e[0]=a.fillStyle),a.fill(),a.restore()}),a.font=s.textFont,a.textAlign="start";var l=this.arrowsSetting.labels;if(l.length===e.arrowVertexes.length)return e.textCenters.forEach(function(e,t){a.save(),a.beginPath();var n=a.measureText(l[t]);a.fillStyle=i===t?s.arrowActiveStyle:c.hexToRgba(s.textColor,s.textAlpha),a.fillText(l[t],e[0]-n.width/2,2*e[1]+4),a.restore()}),i}},{key:"scaleDraw",value:function(r){var a=this.ctx,e=this.vertexes,t=this.canvasWidth,n=this.canvasHeight,i=this.vertexes.activeIndex,s=this.styleSetting;a.clearRect(0,0,t,n),a.save();var o=e.rect;r&&(a.beginPath(),a.rect(o[0],o[1],o[2],o[3]),a.isPointInPath(r.x,r.y),a.clearRect(o[0],o[1],o[2],o[3])),a.restore(),e.arrowVertexes.forEach(function(e,t){a.beginPath(),a.save(),a.moveTo(e[1][0],e[1][1]);for(var n=2;n<e.length;n++)a.lineTo(e[n][0],e[n][1]);a.closePath(),a.fillStyle=e[0],r&&(a.isPointInPath(r.x,r.y)&&a.scale(1.5,1.5),e[0]=a.fillStyle),a.fill(),a.restore()}),a.font=s.textFont,a.textAlign="start";var l=this.arrowsSetting.labels;if(l.length===e.arrowVertexes.length)return e.textCenters.forEach(function(e,t){a.save(),a.beginPath();var n=a.measureText(l[t]);a.fillStyle=i===t?s.arrowActiveStyle:c.hexToRgba(s.textColor,s.textAlpha),a.fillText(l[t],e[0]-n.width/2,2*e[1]+4),a.restore()}),i}}],[{key:"createArrowVertex",value:function(e,t){for(var n=[],r=[],a=0,i=e.margin,s=e.width,o=e.labelMargin,l=e.activeIndex,c=e.height,h=0;h<e.numbers;h++){var f=[];f.push(h===l?t.arrowActiveStyle:t.arrowFillStyle),f.push([a+i,i]),f.push([a+i+s-5,i]),f.push([a+i+s,i+c/2]),f.push([a+i+s-5,i+c]),f.push([a+i,i+c]),f.push([a+i+5,i+c/2]),n.push(f),r.push([s/2+i+a,c+2*i+o]),a+=s+i}return{rect:[0+i,i,s*e.numbers,c],arrowVertexes:n,activeIndex:l,textCenters:r}}}]),n}(),c=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getEventPosition",value:function(e){var t=void 0,n=void 0;return e.layerX||0===e.layerX?(t=e.layerX,n=e.layerY):(e.offsetX||0===e.offsetX)&&(t=e.offsetX,n=e.offsetY),{x:t,y:n}}},{key:"appendCanvas2Target",value:function(e,t,n,r){var a=e instanceof HTMLElement?e:document.getElementById(e),i=document.createElement("canvas");return i.id=t,i.width=n||a.offsetWidth,i.height=r||a.offsetHeight,a.appendChild(i),i}},{key:"generatorUUId",value:function(){return(new Date).getTime().toString(16)}},{key:"hexToRgba",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return 0===e.indexOf("rgba(")?e:(4===e.length&&(e="#"+e.slice(1).repeat(2)),"rgba("+parseInt("0x"+e.slice(1,3))+","+parseInt("0x"+e.slice(3,5))+","+parseInt("0x"+e.slice(5,7))+","+t+")")}}]),e}();return e});var promise=new Promise;